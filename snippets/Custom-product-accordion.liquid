{% liquid
  assign product_resource = product | default: closest.product
  assign selected_variant = selected_variant | default: product_resource.selected_or_first_available_variant

  assign bonus_info = product_resource.metafields.product.bonus_info
  assign outline = product_resource.metafields.product.outline
  assign description_meta = product_resource.metafields.product.description
  assign notes = product_resource.metafields.product.notes
  assign wrapping = product_resource.metafields.product.wrapping
  assign about_product = product_resource.metafields.product.about
  assign safety = product_resource.metafields.product.safety
  assign release_note_variant = selected_variant.metafields.variant.information_release_note
  assign release_note = product_resource.metafields.product.release_note
  assign preorder_deadline = product_resource.metafields.product.preorder_deadline_note
  assign sell_start_at = product_resource.metafields.product.sell_start_at
  assign sell_end_at = product_resource.metafields.product.sell_end_at
  assign is_free_shipping = product_resource.metafields.product.is_free_shipping
  assign extra_shipping_cost = product_resource.metafields.product.extra_shipping_cost
  assign shipping_note = product_resource.metafields.product.shipping_note
%}

<accordion-custom class="product-accordion">
  {% if bonus_info != blank or product_resource.description != blank %}
    <details class="details" open>
      <summary class="product-accordion__summary">
        <span class="h5">特典情報を見る</span>
        <span class="svg-wrapper icon-plus">{{- 'icon-plus.svg' | inline_asset_content -}}</span>
      </summary>
      <div class="details-content product-accordion__body">
        {% if bonus_info != blank %}
          {{ bonus_info | raw }}
        {% else %}
          {{ product_resource.description }}
        {% endif %}
      </div>
    </details>
  {% endif %}

  {% liquid
    assign detail_content = outline
    if detail_content == blank
      assign detail_content = description_meta
    endif
    if detail_content == blank
      assign detail_content = product_resource.description
    endif
  %}
  {% if detail_content != blank %}
    <details class="details">
      <summary class="product-accordion__summary">
        <span class="h5">商品の詳細を見る</span>
        <span class="svg-wrapper icon-plus">{{- 'icon-plus.svg' | inline_asset_content -}}</span>
      </summary>
      <div class="details-content product-accordion__body">
        {{ detail_content }}
      </div>
    </details>
  {% endif %}

  {% if release_note_variant != blank or release_note != blank or preorder_deadline != blank or sell_start_at != blank or sell_end_at != blank or is_free_shipping != blank or extra_shipping_cost != blank or shipping_note != blank %}
    <details class="details">
      <summary class="product-accordion__summary">
        <span class="h5">発送予定/送料について</span>
        <span class="svg-wrapper icon-plus">{{- 'icon-plus.svg' | inline_asset_content -}}</span>
      </summary>
      <div class="details-content product-accordion__body">
        <ul class="product-accordion__list">
          {% if release_note_variant != blank %}
            <li><strong>発売日：</strong>{{ release_note_variant }}</li>
          {% endif %}
          {% if release_note != blank %}
            <li><strong>販売期間：</strong>{{ release_note }}</li>
          {% endif %}
          {% if preorder_deadline != blank %}
            <li><strong>予約締切：</strong>{{ preorder_deadline }}</li>
          {% endif %}
          {% if sell_start_at != blank %}
            <li><strong>販売開始：</strong>{{ sell_start_at | date: "%Y年%-m月%-d日" }}</li>
          {% endif %}
          {% if sell_end_at != blank %}
            <li><strong>販売終了：</strong>{{ sell_end_at | date: "%Y年%-m月%-d日" }}</li>
          {% endif %}
          {% if is_free_shipping == true %}
            <li><strong>送料：</strong>送料無料</li>
          {% elsif extra_shipping_cost != blank %}
            <li><strong>送料：</strong>{{ extra_shipping_cost }}</li>
          {% endif %}
          {% if shipping_note != blank %}
            <li>{{ shipping_note }}</li>
          {% endif %}
        </ul>
      </div>
    </details>
  {% endif %}

  {% if notes != blank %}
    <details class="details">
      <summary class="product-accordion__summary">
        <span class="h5">ご注意いただきたい事項について</span>
        <span class="svg-wrapper icon-plus">{{- 'icon-plus.svg' | inline_asset_content -}}</span>
      </summary>
      <div class="details-content product-accordion__body">
        {{ notes }}
      </div>
    </details>
  {% endif %}

  {% if wrapping != blank or description_meta != blank %}
    <details class="details">
      <summary class="product-accordion__summary">
        <span class="h5">ラッピングについて</span>
        <span class="svg-wrapper icon-plus">{{- 'icon-plus.svg' | inline_asset_content -}}</span>
      </summary>
      <div class="details-content product-accordion__body">
        {{ wrapping | default: description_meta }}
      </div>
    </details>
  {% endif %}

  {% liquid
    assign about_content = about_product
    if about_content == blank
      assign about_content = outline
    endif
    if about_content == blank
      assign about_content = description_meta
    endif
  %}
  {% if about_content != blank %}
    <details class="details">
      <summary class="product-accordion__summary">
        <span class="h5">この商品について</span>
        <span class="svg-wrapper icon-plus">{{- 'icon-plus.svg' | inline_asset_content -}}</span>
      </summary>
      <div class="details-content product-accordion__body">
        {{ about_content }}
      </div>
    </details>
  {% endif %}

  {% if safety != blank %}
    <details class="details">
      <summary class="product-accordion__summary">
        <span class="h5">安全にご利用いただくために</span>
        <span class="svg-wrapper icon-plus">{{- 'icon-plus.svg' | inline_asset_content -}}</span>
      </summary>
      <div class="details-content product-accordion__body">
        {{ safety }}
      </div>
    </details>
  {% endif %}
</accordion-custom>
